### 🔄 项目认知与上下文
- **每次新对话开始时，务必阅读 `PLANNING.md`**，以了解项目的架构、目标、风格和约束。
- **在开始新任务前检查 `TASK.md`**。如果任务未列出，请添加简要描述和今天的日期。
- **按照 `PLANNING.md` 中描述的命名规范、文件结构和架构模式保持一致**。
- **执行 Python 命令（包括单元测试）时始终使用 venv_linux 虚拟环境**。

### 🧱 代码结构与模块化
- **单个文件不得超过 500 行代码。** 如果文件接近此限制，请通过拆分为模块或辅助文件进行重构。
- **将代码按功能或职责清晰地组织为独立模块**。
  对于 agent，推荐结构如下：
    - `agent.py` - 主要 agent 定义与执行逻辑
    - `tools.py` - agent 使用的工具函数
    - `prompts.py` - 系统提示词
- **使用清晰、一致的导入方式**（包内优先使用相对导入）。
- **使用 python_dotenv 和 load_env() 管理环境变量**。

### 🧪 测试与可靠性
- **为所有新功能（函数、类、路由等）编写 Pytest 单元测试**。
- **每次更新逻辑后，检查现有单元测试是否需要更新，如有需要请及时修改**。
- **测试应放在 `/tests` 文件夹中，结构与主应用保持一致**。
  - 至少包括：
    - 1 个正常用例测试
    - 1 个边界情况测试
    - 1 个失败用例测试

### ✅ 任务完成
- **任务完成后立即在 `TASK.md` 中标记**。
- 开发过程中发现的新子任务或 TODO，请添加到 `TASK.md` 的“开发中发现”部分。

### 📎 风格与规范
- **主要编程语言为 Python**。
- **遵循 PEP8，使用类型注解，并用 `black` 格式化代码**。
- **数据校验使用 `pydantic`**。
- API 推荐使用 `FastAPI`，ORM 推荐使用 `SQLAlchemy` 或 `SQLModel`（如适用）。
- **所有函数均需编写 Google 风格的 docstring**，例如：
  ```python
  def example():
      """
      简要说明。

      Args:
          param1 (type): 描述。

      Returns:
          type: 描述。
      """
  ```

### 📚 文档与可解释性
- **新增功能、依赖变更或安装步骤修改时，及时更新 `README.md`**。
- **为非显而易见的代码添加注释，确保中级开发者也能理解**。
- 编写复杂逻辑时，**添加内联 `# Reason:` 注释，解释原因而不仅仅是做了什么**。

### 🧠 AI 行为规范
- **绝不假设缺失的上下文，如有疑问请主动提问**。
- **绝不臆造库或函数——仅使用已知、经过验证的 Python 包**。
- **在代码或测试中引用文件路径和模块名前，务必确认其存在**。
- **除非有明确指示或 `TASK.md` 中的任务要求，绝不删除或覆盖现有代码**。